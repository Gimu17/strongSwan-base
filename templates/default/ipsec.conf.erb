# ipsec.conf - strongSwan IPsec configuration file

# basic configuration

config setup
    # nat_traversal=<%= node['strongswan']['ipsec']['tunable']['natt'] %>
    
conn %default
    ikelifetime=60m
    keylife=20m
    rekeymargin=3m
    keyingtries=1
    keyexchange=<%= node['strongswan']['ipsec']['tunable']['ike_version'] %>
    pfs=no
    authby=secret

conn client
    ike=3des-sha256-modp1536
    esp=3des-sha256
    leftid=<%= node['strongswan']['ipsec']['tunable']['left']['id'] %>
    # The "left" parameter is the gateway's private IP 
    left=<%= node['strongswan']['ipsec']['tunable']['left']['left'] %>
    # We are protecting the entire VPC, not just this subnet
    leftsubnet=<%= node['strongswan']['ipsec']['tunable']['left']['subnet'] %>
    leftfirewall=yes
    right=<%= node['strongswan']['ipsec']['tunable']['right']['right'] %>
    rightid=<%= node['strongswan']['ipsec']['tunable']['right']['id'] %>
    # The virtual IP pool is outside the VPC!
    rightsubnet=<%= node['strongswan']['ipsec']['tunable']['right']['subnet'] %>
    auto=add

# Add connections here.

# include /var/lib/strongswan/ipsec.conf.inc
